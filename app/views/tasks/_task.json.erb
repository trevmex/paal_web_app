{
  "title": "<%= task.title -%>",
  "task_type": "<%= task.task_type -%>",
  
  "subtasks": [
    <% task.subtasks.each do |subtask| -%>
      <%= render :partial => "task", :locals => {:task => subtask.task} -%>
      <% if subtask != task.subtasks.last -%>
        ,
      <% end -%>
    <% end -%>
  ],
  
  "components": [
    <% task.components.each do |component| -%>
      {
        "description": "<%= component.description -%>",
        "component_type": "<%= component.component_type -%>",
        "media": "<%= component.media.url -%>"
      }
      <% if component != task.components.last -%>
        ,
      <% end -%>
    <% end -%>
  ]
}
